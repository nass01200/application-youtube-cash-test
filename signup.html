<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Inscription • Dopeur Chaine YouTube</title>
<style>
body{margin:0;background:#0a0b10;color:#f5f5f7;font-family:system-ui,-apple-system,Segoe UI,Roboto,"SF Pro",sans-serif;display:flex;min-height:100vh;align-items:center;justify-content:center}
.card{background:#111319;border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:16px;max-width:480px;width:92vw}
.row{display:flex;gap:12px;align-items:center}
.grid{display:grid;grid-template-columns:1fr;gap:10px}
input,button{background:rgba(255,255,255,.06);color:#f5f5f7;border:1px solid rgba(255,255,255,.1);border-radius:10px;padding:10px 12px;font-size:14px}
button{cursor:pointer}
.primary{background:linear-gradient(90deg,#6a5cff,#3bc8ff);border:none}
.links{display:flex;justify-content:space-between;margin-top:10px}
.badge{font-size:12px;color:#9fa4b3}
</style>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
const SUPABASE_URL='https://obrhatwvdhkdcgpjrpou.supabase.co';
const SUPABASE_ANON_KEY='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9icmhhdHd2ZGhrZGNncGpycG91Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzODcwNjYsImV4cCI6MjA3ODk2MzA2Nn0.DkoXBYO_8OJP5CsOxspg1n2Wdh1HT5R3egxvsHeYuJM';
let supabaseClient=null;try{if(SUPABASE_URL&&SUPABASE_ANON_KEY){supabaseClient=supabase.createClient(SUPABASE_URL,SUPABASE_ANON_KEY,{auth:{persistSession:true,autoRefreshToken:true}})}}catch(e){}
</script>
</head>
<body>
  <div class="card">
    <div class="row" style="justify-content:space-between"><div class="title">Inscription</div><span class="badge">Dopeur Chaine YouTube</span></div>
    <div class="grid">
      <label>Email</label>
      <input id="email" type="email" placeholder="email">
      <label>Pseudo</label>
      <input id="pseudo" placeholder="pseudo">
      <label>Mot de passe (≥6)</label>
      <input id="password" type="password" placeholder="mot de passe">
      <button id="signupBtn" class="primary">Créer un compte</button>
      <div id="status" class="badge"></div>
      <div class="row" style="justify-content:flex-end"><button id="createAdmin">Créer admin par défaut</button></div>
    </div>
    <div class="links">
      <a href="login.html" class="badge">Déjà inscrit ? Connexion</a>
    </div>
  </div>
<script>
async function doSignup(email,pseudo,password){
  const s=document.getElementById('status');s.textContent=''
  if(!email||!pseudo||!password){s.textContent='Champs requis';return}
  if(password.length<6){s.textContent='Mot de passe trop court';return}
  try{
    const c=supabaseClient
    const {data,error}=await c.auth.signUp({email,password,options:{data:{pseudo}}})
    if(error){s.textContent=error.message;return}
    try{const uid=data?.user?.id||null;if(uid){await c.from('profiles').upsert({id:uid,email,pseudo},{onConflict:'id'})}}catch(e){}
    try{await c.auth.signOut()}catch(e){}
    s.textContent='Un email de confirmation a été envoyé. Validez votre adresse pour continuer.'
    setTimeout(()=>{location.href='login.html'},800)
  }catch(e){document.getElementById('status').textContent=String(e?.message||e)}
}
document.getElementById('signupBtn').onclick=async()=>{
  const email=(document.getElementById('email').value||'').trim()
  const pseudo=(document.getElementById('pseudo').value||'').trim()
  const password=(document.getElementById('password').value||'').trim()
  await doSignup(email,pseudo,password)
}
document.getElementById('createAdmin').onclick=async()=>{
  await doSignup('admin01@example.com','admin01','admin01')
}
</script>
</body>
</html>
